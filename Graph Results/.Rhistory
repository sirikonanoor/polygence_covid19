reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(1606, 357, 171, 1867, 494, 649)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(3, 357, 171, 1867, 494, 649)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 200, 171, 1867, 494, 649)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 180, 171, 1867, 494, 649)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 180, 154, 1867, 494, 649)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 180, 154, 1867, 494, 649)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 180, 154, 89, 111, 3)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative number of infected people"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 180, 154, 89, 111, 3)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation step (days)",
y = "Cumulative Number of Infected People"
)
library(dplyr)
library(ggplot2)
library(tidyr)
# set threshold for superspreader
super_spreader <- 10
# num steps
num_steps <- 100
# read data in and transpose
reff_data <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig4reff.csv",
sep = ",") %>%
t() %>%
as.data.frame() %>%
# keep only superspreaders
filter(
rowSums(.) > super_spreader
)
# make cumulative sum
reff_cummulative <- data.frame(t(apply(reff_data, 1, cumsum)))
# rename columns
colnames(reff_cummulative) <- 1:num_steps
# add person index
reff_cummulative <- reff_cummulative %>%
mutate(
person = row_number()
)
# reshape dataframe (pivot longer)
reff_final <- reff_cummulative %>%
pivot_longer(-person,
names_to = "step",
values_to = "infected") %>%
arrange(person)
# make steps integers
reff_final$step <- as.numeric(reff_final$step)
# "factorize" people
reff_final$person <- factor(reff_final$person)
# plot 1 - each line is a person
reff_final %>%
filter(person %in% c(8, 180, 154, 89, 111, 3)) %>%
ggplot(aes(x = step,
y = infected,
colour = person,
group = person)) +
geom_line(lwd = 0.5) +
theme_light() +
labs(
x = "Simulation Step (days)",
y = "Cumulative Number of Infected People"
)
# Figure 1. b)
data1 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_infonly.csv",
sep = ",")
colnames(data1) <- c("sim_step", "pct_inf1")
data2 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_vacc.csv",
sep = ",")
colnames(data2) <- c("sim_step", "pct_inf2")
data <- left_join(data1, data2, by='sim_step')
colors <- c("Infection with no Vaccination\n" = "red",
"Infection with 10% Compliance" = "blue")
data %>%
ggplot(aes(x = sim_step)) +
# first line
geom_line(aes(y = pct_inf1,
color = "Infection with no Vaccination\n"),
size = 1) +
# second line
geom_line(aes(y = pct_inf2,
color = "Infection with 10% Compliance"),
size = 1) +
labs(x = "Simulation Step # (days)",
y = "Percent of Infected People",
color = "Legend") +
scale_color_manual(values = colors) +
theme_light() +
theme(legend.position = (c(0.8, 0.4))) +
scale_y_continuous(limits = c(0, 100), breaks=seq(0, 100, 10)) +
scale_x_continuous(limits = c(0, 100), breaks=seq(0, 100, 10))
library(dplyr)
library(ggplot2)
# Figure 1. b)
data1 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_infonly.csv",
sep = ",")
colnames(data1) <- c("sim_step", "pct_inf1")
data2 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_vacc.csv",
sep = ",")
colnames(data2) <- c("sim_step", "pct_inf2")
data <- left_join(data1, data2, by='sim_step')
colors <- c("Infection with no Vaccination\n" = "red",
"Infection with 10% Compliance" = "blue")
data %>%
ggplot(aes(x = sim_step)) +
# first line
geom_line(aes(y = pct_inf1,
color = "Infection with no Vaccination\n"),
size = 1) +
# second line
geom_line(aes(y = pct_inf2,
color = "Infection with 10% Compliance"),
size = 1) +
labs(x = "Simulation Step # (days)",
y = "Percent of Infected People",
color = "Legend") +
scale_color_manual(values = colors) +
theme_light() +
theme(legend.position = (c(0.8, 0.4))) +
scale_y_continuous(limits = c(0, 100), breaks=seq(0, 100, 10)) +
scale_x_continuous(limits = c(0, 100), breaks=seq(0, 100, 10))
# Figure 1. b)
data1 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_infonly.csv",
sep = ",")
colnames(data1) <- c("sim_step", "pct_inf1")
data2 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_vacc.csv",
sep = ",")
colnames(data2) <- c("sim_step", "pct_inf2")
data <- left_join(data1, data2, by='sim_step')
colors <- c("Infection with no Vaccination\n" = "red",
"Infection with 10% Compliance" = "blue")
data %>%
ggplot(aes(x = sim_step)) +
# first line
geom_line(aes(y = pct_inf1,
color = "Infection with no Vaccination\n"),
size = 1) +
# second line
geom_line(aes(y = pct_inf2,
color = "Infection with 10% Compliance"),
size = 1) +
labs(x = "Simulation Step # (days)",
y = "Percent of Infected People",
color = "Legend") +
scale_color_manual(values = colors) +
theme_light() +
theme(legend.position = (c(0.8, 0.4))) +
scale_y_continuous(limits = c(0, 100), breaks=seq(0, 100, 10)) +
scale_x_continuous(limits = c(0, 100), breaks=seq(0, 100, 10))
View(data1)
# Figure 1. b)
data1 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_infonly.csv",
sep = ",")
colnames(data1) <- c("sim_step", "pct_inf1")
data2 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_vacc.csv",
sep = ",")
colnames(data2) <- c("sim_step", "pct_inf2")
data2 <- read.table("/Users/sirikonanoor/Documents/Polygence/csvfiles/fig.1b_vacc.csv",
sep = ",")
colnames(data2) <- c("sim_step", "pct_inf2")
